<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:jsp="http://java.sun.com/JSP/Page"
      xmlns:ice="http://www.icesoft.com/icefaces/component">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
</head>
<body>
  <ui:composition template="/template.xhtml">
    <ui:param name="pageTitle" value="#{bundlePageInfo.editGuestBookQuestionnaireTitle} - #{VDCRequest.dataversePageTitle}"/>
    <ui:define name="metadata">
        <f:metadata>
             <f:event type="preRenderView" listener="#{EditGuestbookQuestionnairePage.preRenderView}"/>
        </f:metadata>
    </ui:define>
    <ui:define name="body">
      <ice:form id="form1">
        <ice:inputHidden id="vdcId" value="#{VDCRequest.currentVDCId}"/>
        <div class="dvn_section">
          <div class="dvn_sectionTitle">
            <ice:outputText value="#{bundlePageInfo.editGuestBookQuestionnaireTitle}"/>
          </div>
          <div class="dvn_sectionBox dvnEditTermsForm">
            <div class="dvn_margin12">
              <div jsfc="ice:panelGroup" styleClass="dvnInformationMessage">
                <div class="dvnMsgBlockContainer">
                  <ice:outputText value="#{bundlePageInfo.editGuestBookQuestionnaireHelp}" escape="false"/>
                </div>
              </div>

              <ice:message for="warningMessage" styleClass="warningMessage" id="warningMessage"/>
              
              <div class="dvnGuestBookCheckbox">
                <ice:selectBooleanCheckbox value="#{EditGuestbookQuestionnairePage.guestBookQuestionnaire.enabled}"/>
                <ice:outputText value="Enable File Download Guestbook"/>
              </div>
              
              <div class="dvn_padTop dvn_padBottom"> 
                <p>
                  <ice:graphicImage value="/resources/images/icon_info.gif" styleClass="dvn_icon"/>
                  <ice:outputText styleClass="vdcHelpText" value=" #{bundlePageInfo.editGuestBookAddQuestionHelp}" escape="false"/>
                </p>
                <ice:panelGrid cellpadding="0" cellspacing="0" columns="2"
                       columnClasses="vdcColPadded, vdcColPadded" id="gridPanel2">
                    <div jsfc="ice:panelGroup">
                        <ice:outputText value="Custom Field Type"/>
                    </div>
                    <div jsfc="ice:panelGroup">
                        <ice:selectOneMenu immediate="false" partialSubmit="true" valueChangeListener="#{EditGuestbookQuestionnairePage.toggleQuestionType}"
                                           value="#{EditGuestbookQuestionnairePage.questionType}" binding="#{EditGuestbookQuestionnairePage.questionTypeListBox}">
                            <f:selectItems value="#{EditGuestbookQuestionnairePage.questionTypeSelectItems}"/>
                        </ice:selectOneMenu>
                    </div>
                    <div jsfc="ice:panelGroup">
                        <ice:outputText value="Custom Field Question"/>
                    </div>
                    <div jsfc="ice:panelGroup">
                        <ice:inputText id="input_questionText" size="90" binding="#{EditGuestbookQuestionnairePage.inputCustomQuestionText}"></ice:inputText>
                        <ice:dataTable cellpadding="0" cellspacing="0" 
                                       styleClass="dvnEditGuestbookCustomQuestions"
                                       rendered="#{EditGuestbookQuestionnairePage.questionType == 'radiobuttons'}"
                                       value="#{EditGuestbookQuestionnairePage.newQuestion.customQuestionValues}" var="addValue">
                          <ice:column>
                            <ice:outputText value="Answer"/>
                          </ice:column>
                          <ice:column>
                            <ice:inputText id="input_AnswerValueAdd"
                                           value="#{addValue.valueString}"
                                           size="45"
                                           maxlength="255"
                                           required="true" requiredMessage="This field is required."/>
                            <ice:message styleClass="errorMessage" for="input_AnswerValue"/>
                          </ice:column>
                          <ice:column>
                            <ice:commandButton image="/resources/images/icon_add.gif" actionListener="#{EditGuestbookQuestionnairePage.addCustomRowInit}"/>
                            <ice:commandButton 
                                rendered="#{EditGuestbookQuestionnairePage.newQuestion.customQuestionValues.size() > 1}" immediate="true"
                                image="/resources/images/icon_remove.gif" actionListener="#{EditGuestbookQuestionnairePage.removeCustomRowInit}" />
                          </ice:column>
                       </ice:dataTable>
                    </div>
                </ice:panelGrid>

                <div class="dvnFormPadding">
                    <ice:commandButton partialSubmit="true" value="Add Custom Field" action="#{EditGuestbookQuestionnairePage.addCustomQuestion}"/>
                </div>
                
                <div jsfc="ice:panelGroup" styleClass="dvnWarningMessage" rendered="#{!empty VDCRender.flash.customQuestionWarningMessage}">
                  <div class="dvnMsgBlockContainer">
                    <p><ice:outputText id="addFieldMessage" value="#{VDCRender.flash.customQuestionWarningMessage}"/></p>
                  </div>
                </div>

                <table width="100%" cellspacing="0" cellpadding="0" class="iceDatTbl dvnStaticTable dvnEditGuestbookCustomQuestions">
                    <thead>
                        <tr>
                            <th class="iceDatTblColHdr1 dvnGuestbookCustomQuestionsColHdr1 dvnGuestbookCustomQuestionsHdr">
                                <span class="iceOutTxt">Required</span>
                            </th>
                            <th class="iceDatTblColHdr2 dvnGuestbookCustomQuestionsColHdr2 dvnGuestbookCustomQuestionsHdr">
                                <span class="iceOutTxt">Guestbook User Information + Custom Questions</span>
                            </th>
                            <th class="iceDatTblColHdr1 dvnGuestbookCustomQuestionsColHdr3 dvnGuestbookCustomQuestionsHdr">
                                <span class="iceOutTxt">Action</span>
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="iceDatTblRow1 dvnGuestbookCustomQuestionsRow1">
                            <td class="iceDatTblCol1 dvnGuestbookCustomQuestionsCol1">
                                <ice:selectBooleanCheckbox value="#{EditGuestbookQuestionnairePage.guestBookQuestionnaire.firstNameRequired}"/>
                            </td>
                            <td class="iceDatTblCol2 dvnGuestbookCustomQuestionsCol2">
                                <ice:outputText value="First Name"/>
                            </td>
                            <td class="iceDatTblCol1 dvnGuestbookCustomQuestionsCol3">
                                
                            </td>
                        </tr>

                        <tr class="iceDatTblRow1 dvnGuestbookCustomQuestionsRow1">
                            <td class="iceDatTblCol1 dvnGuestbookCustomQuestionsCol1">
                                <ice:selectBooleanCheckbox value="#{EditGuestbookQuestionnairePage.guestBookQuestionnaire.lastNameRequired}"/>
                            </td>
                            <td class="iceDatTblCol2 dvnGuestbookCustomQuestionsCol2">
                                <ice:outputText value="Last Name"/>
                            </td>
                            <td class="iceDatTblCol1 dvnGuestbookCustomQuestionsCol3">
                                
                            </td>
                        </tr>
                        <tr class="iceDatTblRow1 dvnGuestbookCustomQuestionsRow1">
                            <td class="iceDatTblCol1 dvnGuestbookCustomQuestionsCol1">
                                <ice:selectBooleanCheckbox value="#{EditGuestbookQuestionnairePage.guestBookQuestionnaire.emailRequired}"/>
                            </td>
                            <td class="iceDatTblCol2 dvnGuestbookCustomQuestionsCol2">
                                <ice:outputText value="E-Mail"/>
                            </td>
                            <td class="iceDatTblCol1 dvnGuestbookCustomQuestionsCol3">
                                
                            </td>
                        </tr>
                        <tr class="iceDatTblRow1 dvnGuestbookCustomQuestionsRow1">
                            <td class="iceDatTblCol1 dvnGuestbookCustomQuestionsCol1">
                                <ice:selectBooleanCheckbox value="#{EditGuestbookQuestionnairePage.guestBookQuestionnaire.institutionRequired}"/>
                            </td>
                            <td class="iceDatTblCol2 dvnGuestbookCustomQuestionsCol2">
                                <ice:outputText value="Institution"/>
                            </td>
                            <td class="iceDatTblCol1 dvnGuestbookCustomQuestionsCol3">
                                
                            </td>
                        </tr>
                        <tr class="iceDatTblRow1 dvnGuestbookCustomQuestionsRow1">
                            <td class="iceDatTblCol1 dvnGuestbookCustomQuestionsCol1">
                                <ice:selectBooleanCheckbox value="#{EditGuestbookQuestionnairePage.guestBookQuestionnaire.positionRequired}"/>
                            </td>
                            <td class="iceDatTblCol2 dvnGuestbookCustomQuestionsCol2">
                                <ice:outputText value="Position"/>
                            </td>
                            <td class="iceDatTblCol1 dvnGuestbookCustomQuestionsCol3">
                                
                            </td>
                        </tr>
                    </tbody>
                </table>
                <ice:dataTable cellpadding="0" cellspacing="0" width="100%" 
                                      styleClass="dvnEditGuestbookCustomQuestions"
                                      columnClasses="dvnGuestbookCustomQuestionsCol1,dvnGuestbookCustomQuestionsCol2,dvnGuestbookCustomQuestionsCol3"
                                      binding="#{EditGuestbookQuestionnairePage.customQuestionsDataTable}"
                                      value="#{EditGuestbookQuestionnairePage.customQuestions}" var="customQuestion"
                                      >
                        <ice:column>
                          <ice:selectBooleanCheckbox value="#{customQuestion.customQuestion.required}"/>
                        </ice:column>
                        <ice:column>
                          <ice:outputText value="#{customQuestion.customQuestion.questionString}" 
                                          rendered="#{!customQuestion.editMode}"/>
                          <div>
                            <ice:outputText value="#{customQuestion.customQuestion.customQuestionValueString}" 
                                            rendered="#{!customQuestion.editMode}"/>
                          </div>
                          <ice:inputText id="input_questionTextTable" size="90" 
                                         binding="#{EditGuestbookQuestionnairePage.inputCustomQuestionTextTable}"
                                         value="#{customQuestion.customQuestion.questionString}"
                                         rendered="#{customQuestion.editMode}"></ice:inputText>
                          <ice:dataTable cellpadding="0" cellspacing="0" rendered="#{customQuestion.editMode}"
                                      value="#{customQuestion.customQuestion.customQuestionValues}" var="value">
                              <ice:column>
                                <div jsfc="ice:panelGroup">               
                                  <div jsfc="ice:panelGroup">
                                    <ice:outputText value="Answer"/>
                                    <ice:inputText id="input_AnswerValue"
                                                   value="#{value.valueString}"
                                                   size="45"
                                                   maxlength="255"
                                                   required="true" requiredMessage="This field is required."/>
                                    <ice:message styleClass="errorMessage" for="input_AnswerValue"/>
                                  </div>
                                </div>
                              </ice:column>
                              <ice:column>
                                <ice:commandButton image="/resources/images/icon_add.gif" actionListener="#{EditGuestbookQuestionnairePage.addCustomRow}"/>
                                <ice:commandButton 
                                    rendered="#{customQuestion.customQuestion.customQuestionValues.size() > 1}" 
                                    image="/resources/images/icon_remove.gif" actionListener="#{EditGuestbookQuestionnairePage.removeCustomRow}" />
                              </ice:column>
                           </ice:dataTable>
                        </ice:column>
                        <ice:column>
                            <ice:commandLink value="Remove" rendered="#{EditGuestbookQuestionnairePage.questionRemovable}" 
                                             actionListener="#{EditGuestbookQuestionnairePage.removeCustomQuestion}"/>
                        </ice:column>
                </ice:dataTable>
              </div>
              
              <div class="dvnFormPadding dvnFormMargin">
                <ice:commandButton id="button1" value="Save" action="#{EditGuestbookQuestionnairePage.save_action}"/>
                <ice:commandButton id="button2" value="Cancel" action="#{EditGuestbookQuestionnairePage.cancel_action}"/>
              </div>
            </div>
          </div>
        </div>
      </ice:form>
    </ui:define>
  </ui:composition>
</body>
</html>
