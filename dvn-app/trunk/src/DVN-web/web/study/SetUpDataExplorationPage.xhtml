<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:jsp="http://java.sun.com/JSP/Page"
      xmlns:t="/WEB-INF/tlds/scroller"
      xmlns:ice="http://www.icesoft.com/icefaces/component">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
</head>
<body>
<ui:composition template="/template.xhtml">
<ui:param name="pageTitle" value="Set Up Data Exploration - #{VDCRequest.dataversePageTitle}"/>
<ui:define name="body">

<ice:form id="form1">
    
<ice:inputHidden id="vdcId" value="#{VDCRequest.currentVDCId}"/>

<style type="text/css">

</style>
            <li>
                <ice:outputLink id="hyperlinkM" value="/dvn/faces/ExploreDataPage.xhtml?fileId=#{SetUpDataExplorationPage.studyFileId}"
                                rendered="#{SetUpDataExplorationPage.showCommands}">
                  <ice:outputText id="hyperlinkMText1" value="Explore Data"/>
                </ice:outputLink>
            </li>
<div>
<ice:outputText value="Select A Data File for Data Exploration Set-up"/>
<br></br>
<ice:selectOneMenu value="#{SetUpDataExplorationPage.studyFileId}"  disabled="#{!SetUpDataExplorationPage.selectFile}" partialSubmit="true" binding="#{SetUpDataExplorationPage.selectStudyFile}"
                                         onchange="getElementById('form1:studyFileIdButton').click();">
                    <f:selectItems value="#{SetUpDataExplorationPage.studyFileIdSelectItems}"/>
                </ice:selectOneMenu>
</div>


                        <!-- hidden button that is clicked by select menu's onchange action -->
                        <ice:commandButton id="studyFileIdButton"  visible="false" value="Change" action="#{SetUpDataExplorationPage.resetStudyFileId}"/>
                        <br/>
    <div jsfc="ice:panelGroup" style="float:right; margin-bottom:1em;">
        <ice:commandButton id="validateButton" type="submit" value="Validate" rendered="#{SetUpDataExplorationPage.showCommands}"
                           binding="#{SetUpDataExplorationPage.validateButton}" action="#{SetUpDataExplorationPage.validate}"/>
        <ice:message for="validateButton" id="boxErrorMsg"  styleClass="errorMessage"   />
    </div>
                 
    <div jsfc="ice:panelGroup" style="float:right; margin-bottom:1em;" 
         rendered="#{!SetUpDataExplorationPage.dataTable.visualizationEnabled  and SetUpDataExplorationPage.showCommands}">
        <ice:commandButton type="submit" value="Release" action="#{SetUpDataExplorationPage.release}"/>
    </div>
    <div jsfc="ice:panelGroup" style="float:right; margin-bottom:1em;">
        <ice:commandButton type="submit" value="Un-Release" action="#{SetUpDataExplorationPage.unRelease}"
                           rendered="#{SetUpDataExplorationPage.dataTable.visualizationEnabled and SetUpDataExplorationPage.showCommands}"/>
    </div>

    <div jsfc="ice:panelGroup" style="float:right; margin-bottom:1em;">
        <ice:commandButton type="submit" value="Cancel" action="#{SetUpDataExplorationPage.cancel}" />
    </div>
    <div jsfc="ice:panelGroup" style="float:right; margin-bottom:1em;">
        <ice:commandButton type="submit" value="Save" action="#{SetUpDataExplorationPage.save}" rendered="#{SetUpDataExplorationPage.showCommands}"/>
    </div>
    <div class="dvn_sectionBoxNoBorders">
        <ice:panelTabSet id="tabSet1" rendered="#{SetUpDataExplorationPage.showCommands}">
            <ice:panelTab id="xVariable" label="X-Variable" url="/dvn#{VDCRequest.currentVDCURL}/faces/subsetting/SetUpDataExploration.xhtml&amp;tab=xVariable">
                <div jsfc="ice:panelGroup" panelLayout="flow">

                    <div jsfc="ice:panelGroup" style="overflow:hidden;">
                        <div jsfc="ice:panelGroup" style="width:60%; float:left; margin-right: 2em;">

                            <ice:dataTable width="100%" cellspacing="0" cellpadding="0"  var="group" value="#{SetUpDataExplorationPage.measureGrouping}"
                                               binding="#{SetUpDataExplorationPage.dataTableXAxis}" >
                                    <h:column>
                                        <ice:inputText id="input_measureName"
                                               rendered="false"
                                               value="#{group.varGrouping.name}"
                                               size="25"
                                               maxlength="255"/>
                                    </h:column>
                                    <h:column>
                                        <f:facet name="header">
                                            <ice:outputText value="Select X-Axis Variable"/>
                                        </f:facet>
                                        <ice:selectOneListbox size="2" value="#{SetUpDataExplorationPage.xAxisVariableId}">
                                            <f:selectItems value="#{SetUpDataExplorationPage.dataVariableSelectItems}"/>
                                        </ice:selectOneListbox>
                                    </h:column>
                                    <h:column>
                                        <f:facet name="header">
                                            <ice:outputText value="Units"/>
                                        </f:facet>
                                         <ice:inputText id="input_XAxisUnits"
                                                        value="#{SetUpDataExplorationPage.xAxisUnits}"
                                                       size="25"
                                                       maxlength="255"
                                                       binding="#{SetUpDataExplorationPage.inputXAxisUnits}"/>
                                    </h:column>
                            </ice:dataTable>

                        </div>
                        <div jsfc="ice:panelGroup" style="width:35%; float:left;">

                            Variables Table

                        </div>
                    </div>

                </div>
            </ice:panelTab>

            <ice:panelTab id="measures" label="Measures" url="/dvn#{VDCRequest.currentVDCURL}/faces/subsetting/SetUpDataExploration.xhtml&amp;tab=measures">
                <div jsfc="ice:panelGroup" panelLayout="flow">

                    <div jsfc="ice:panelGroup" style="overflow:hidden;">

                        <div jsfc="ice:panelGroup" style="width:60%; float:left; margin-right: 2em;">

                            <div jsfc="ice:panelGroup">
                                <ice:commandLink id="addMeasureGroup" action="#{SetUpDataExplorationPage.addMeasureGroup}">
                                      <ice:outputText id="addMeasureGroupText" value="+Add Measure"/>
                                 </ice:commandLink>
                            </div>

                            <div jsfc="ice:panelGroup">

                                <ice:dataTable width="100%" cellspacing="0" cellpadding="0"  var="group" value="#{SetUpDataExplorationPage.measureGroups}"
                                               binding="#{SetUpDataExplorationPage.dataTableVarGroup}">
                                    <h:column>
                                        <f:facet name="header">
                                            <ice:outputText value="Name"/>
                                        </f:facet>
                                               <ice:inputText id="input_measureName"
                                               value="#{group.varGroup.name}"
                                               size="25"
                                               maxlength="255"
                                               binding="#{SetUpDataExplorationPage.inputMeasureName}"/>
                                    </h:column>
                                    <h:column>
                                        <f:facet name="header">
                                            <ice:outputText value="Type"/>
                                        </f:facet>
                                        <ice:outputText value="Types Selected: #{group.groupTypesSelectedString}"/>
                                        <ice:commandLink id="editMeasureTypes" visible="#{!group.showTypeList}" actionListener="#{SetUpDataExplorationPage.editMeasureTypes}">
                                             <ice:outputText id="editTypesText" value="Edit Types"/>
                                        </ice:commandLink>
                                        <ice:commandLink id="hideMeasureTypes" visible="#{group.showTypeList}" actionListener="#{SetUpDataExplorationPage.hideMeasureTypes}">
                                             <ice:outputText id="hideTypesText" value="Save Types"/>
                                        </ice:commandLink>
                                        <ice:selectManyListbox size="2" visible="#{group.showTypeList}"  value="#{group.varGroupTypesSelectItems}">
                                            <f:selectItems value="#{SetUpDataExplorationPage.selectMeasureGroupTypes}"/>
                                        </ice:selectManyListbox>

                                    </h:column>
                                    <h:column>
                                        <f:facet name="header">
                                            <ice:outputText value="Variables"/>
                                        </f:facet>
                                        <ice:selectManyListbox size="2" visible="false" value="#{group.dataVariablesSelected}">
                                            <f:selectItems value="#{SetUpDataExplorationPage.dataVariableSelectItems}"/>
                                        </ice:selectManyListbox>
                                        <ice:outputText value="Variables Selected: #{group.numberOfVariablesSelected}"/>
                                        <ice:commandLink id="editVariables" actionListener="#{SetUpDataExplorationPage.editMeasureVariables}">
                                            <f:param name="varGroupId" value="#{group.varGroup.id}"/>
                                            <ice:outputText id="editVariablesText" value="Edit Variables"/>
                                        </ice:commandLink>
                                    </h:column>
                                    <h:column>
                                        <f:facet name="header">
                                            <ice:outputText value="Units"/>
                                        </f:facet>
                                         <ice:inputText id="input_measureUnits"
                                               value="#{group.varGroup.units}"
                                               size="25"
                                               maxlength="255"
                                               binding="#{SetUpDataExplorationPage.inputMeasureUnits}"/>
                                    </h:column>
                                    <h:column>
                                        <f:facet name="header">
                                            <ice:outputText value="Actions"/>
                                        </f:facet>
                                        <ice:commandLink id="deleteMeasureGroup" action="#{SetUpDataExplorationPage.deleteMeasureGroup}">
                                             <ice:outputText id="deleteMeasureGroupText" value="Delete"/>
                                        </ice:commandLink>
                                    </h:column>
                                </ice:dataTable>

                            </div>

                            <div jsfc="ice:panelGroup">
                                <ice:commandLink id="addMeasureGroupType" action="#{SetUpDataExplorationPage.addMeasureGroupType}">
                                      <ice:outputText id="addMeasureGroupTypeText" value="+Add Measure Type"/>
                                 </ice:commandLink>
                            </div>

                            <div jsfc="ice:panelGroup">

                                <ice:dataTable width="100%" cellspacing="0" cellpadding="0" var="groupType" value="#{SetUpDataExplorationPage.measureGroupTypes}"
                                               binding="#{SetUpDataExplorationPage.dataTableVarGroupType}">
                                    <h:column>
                                        <f:facet name="header">
                                            <ice:outputText value="Name"/>
                                        </f:facet>
                                         <ice:inputText id="input_measureUnits"
                                               value="#{groupType.name}"
                                               size="25"
                                               maxlength="255"
                                               binding="#{SetUpDataExplorationPage.inputGroupTypeName}"/>
                                    </h:column>
                                     <h:column>
                                        <f:facet name="header">
                                            <ice:outputText value="Actions"/>
                                        </f:facet>
                                        <ice:commandLink id="deleteMeasureGroupType" action="#{SetUpDataExplorationPage.deleteMeasureGroupType}">
                                             <ice:outputText id="deleteMeasureGroupTypeText" value="Delete"/>
                                        </ice:commandLink>
                                    </h:column>
                                </ice:dataTable>

                            </div>

                        </div>
                        <div jsfc="ice:panelGroup" style="width:35%; float:left;">

                            <div jsfc="ice:panelGroup" rendered="#{SetUpDataExplorationPage.showMeasureVariables}">
                                <ice:inputText id="inputUpdateVariableList"
                                               size="25"
                                               maxlength="255"
                                               partialSubmit="true"
                                               onchange="submit()"
                                               onkeyup="getElementById('form1:updateMeasureVariables').click();"
                                               valueChangeListener="#{SetUpDataExplorationPage.updateMeasureVariableList}"
                                               binding="#{SetUpDataExplorationPage.inputVariableMeasure}"/>
                                <ice:commandButton id="saveMeasureVariables" visible="true" value="Save Variable Update"
                                                   action="#{SetUpDataExplorationPage.saveMeasureVariableUpdate}"/>
                                <ice:commandButton id="cancelMeasureVariables" visible="true" value="Cancel"
                                                   action="#{SetUpDataExplorationPage.cancelVariableUpdate}"/>
                                <ice:commandButton id="updateMeasureVariables" visible="false" action="#{SetUpDataExplorationPage.updateMeasureVariableList}"/>
                                <ice:dataTable width="100%" cellspacing="0" cellpadding="0" id="measureVariables" var="dataVariableUI" value="#{SetUpDataExplorationPage.dvMeasureFilteredListUI}">
                                    <ice:column>
                                        <f:facet name="header">
                                            <ice:outputText value="Select"/>
                                        </f:facet>
                                        <ice:selectBooleanCheckbox id="measureVariableCheckBoxes" styleClass="measureVariableCheckBoxes"
                                                                   partialSubmit="false" value="#{dataVariableUI.selected}"/>
                                    </ice:column>
                                    <ice:column>
                                        <f:facet name="header">
                                            <ice:outputText value="Name"/>
                                        </f:facet>
                                        <ice:outputLabel value="#{dataVariableUI.dataVariable.name}"/>
                                    </ice:column>
                                </ice:dataTable>
                            </div>

                        </div>

                    </div>

                </div>

            </ice:panelTab>

            <ice:panelTab id="filters" label="Filters" url="/dvn#{VDCRequest.currentVDCURL}/faces/subsetting/SetUpDataExploration.xhtml&amp;tab=filters">
                <div jsfc="ice:panelGroup" panelLayout="flow">

                    <div jsfc="ice:panelGroup" style="overflow:hidden;">

                        <div jsfc="ice:panelGroup" style="width:60%; float:left; margin-right: 2em;">
                            
                            <ice:commandLink id="addFilterGroup" action="#{SetUpDataExplorationPage.addFilterGrouping}">
                                 <ice:outputText id="addFilterGroupText" value="+ Add Group"/>
                            </ice:commandLink>
                            
                            <div jsfc="ice:panelGroup">

                                <div jsfc="ice:panelSeries" id="filterPanelGroupings"
                                     width="100%" cellspacing="0" cellpadding="0"  var="grouping" value="#{SetUpDataExplorationPage.filterGroupings}">
                                    <h:column>
                                        <ice:outputText value="Group"/>
                                        <ice:inputText id="input_groupingName"
                                                   value="#{grouping.varGrouping.name}"
                                                   size="25"
                                                   maxlength="255"
                                                   binding="#{SetUpDataExplorationPage.inputFilterGroupingName}"/>
                                       <ice:commandLink id="addFilterGroup"  binding="#{SetUpDataExplorationPage.addFilterGroupLink}"
                                                        value="#{grouping.varGrouping.id}"
                                                        action="#{SetUpDataExplorationPage.addFilterGroup}">
                                            <ice:outputText id="addFilterGroupText" value="+ Add Filter"/>
                                       </ice:commandLink>

                                       <ice:dataTable width="100%" cellspacing="0" cellpadding="0"  var="filter" value="#{grouping.varGroupUI}"
                                                   binding="#{SetUpDataExplorationPage.dataTableFilterGroup}">
                                           <h:column>
                                               <f:facet name="header">
                                                   <ice:outputText value="Filter"/>
                                               </f:facet>
                                               <ice:inputText id="input_filterGroupName"
                                                             value="#{filter.varGroup.name}"
                                                             size="25"
                                                             maxlength="255"
                                                             binding="#{SetUpDataExplorationPage.inputFilterGroupName}"/>
                                            </h:column>
                                            <h:column>
                                                <f:facet name="header">
                                                    <ice:outputText value="Type"/>
                                                </f:facet>
                                                <ice:outputText value="Types Selected: #{filter.groupTypesSelectedString}"/>
                                                <ice:commandLink id="editFilterTypes" visible="#{!filter.showTypeList}" actionListener="#{SetUpDataExplorationPage.editFilterTypes}">
                                                    <ice:outputText id="editFilterTypesText" value="Edit Types"/>
                                                </ice:commandLink>
                                                <ice:commandLink id="hideFilterTypes" visible="#{filter.showTypeList}" actionListener="#{SetUpDataExplorationPage.hideFilterTypes}">
                                                    <ice:outputText id="hideFilterTypesText" value="Save Types"/>
                                                </ice:commandLink>

                                                <ice:selectManyListbox size="2" visible="#{filter.showTypeList}" value="#{filter.varGroupTypesSelectItems}" >
                                                    <f:selectItems value="#{grouping.varGroupTypesSelect}"/>
                                                </ice:selectManyListbox>
                                                </h:column>
                                            <h:column>
                                                <f:facet name="header">
                                                    <ice:outputText value="Variables"/>
                                                </f:facet>
                                                <ice:selectManyListbox visible="false" size="2" value="#{filter.dataVariablesSelected}">
                                                    <f:selectItems value="#{SetUpDataExplorationPage.dataVariableSelectItems}"/>
                                                </ice:selectManyListbox>
                                                <ice:outputText value="Variables Selected: #{filter.numberOfVariablesSelected}"/>
                                                <ice:commandLink id="editVariables" actionListener="#{SetUpDataExplorationPage.editFilterVariables}">
                                                    <ice:outputText id="editVariablesText" value="Edit Variables"/>
                                                </ice:commandLink>
                                            </h:column>
                                            <h:column>
                                                <f:facet name="header">
                                                    <ice:outputText value="Actions"/>
                                                </f:facet>
                                                <ice:commandLink id="deleteFilterGroup" action="#{SetUpDataExplorationPage.deleteFilterGroup}">
                                                     <ice:outputText id="deleteFilterGroupText" value="Delete"/>
                                                </ice:commandLink>
                                            </h:column>
                                        </ice:dataTable>

                                        <ice:commandLink id="addFilterGroupType"  binding="#{SetUpDataExplorationPage.addFilterGroupTypeLink}"
                                                value="#{grouping.varGrouping.id}"
                                                action="#{SetUpDataExplorationPage.addFilterGroupType}">
                                              <ice:outputText id="addFilterGroupText" value="+ Add Filter Type"/>
                                        </ice:commandLink>

                                       <ice:dataTable width="100%" cellspacing="0" cellpadding="0"  var="type" value="#{grouping.varGroupTypesUI}"
                                                   binding="#{SetUpDataExplorationPage.dataTableFilterGroupType}">
                                           <h:column>
                                                <f:facet name="header">
                                                    <ice:outputText value="Filter Type"/>
                                                </f:facet>
                                               <ice:inputText id="input_filterGroupName"
                                                              value="#{type.varGroupType.name}"
                                                             size="25"
                                                             maxlength="255"
                                                             binding="#{SetUpDataExplorationPage.inputFilterGroupTypeName}"/>
                                            </h:column>
                                            <h:column>
                                            <f:facet name="header">
                                                <ice:outputText value="Action"/>
                                            </f:facet>
                                            <ice:commandLink id="deleteFilterGroupType" action="#{SetUpDataExplorationPage.deleteFilterGroupType}">
                                                 <ice:outputText id="deleteFilterGroupTypeText" value="Delete"/>
                                            </ice:commandLink>
                                            </h:column>

                                        </ice:dataTable>
                                    </h:column>
                                </div>

                            </div>
                        </div>
                        <div jsfc="ice:panelGroup" style="width:35%; float:left;">

                            <div jsfc="ice:panelGroup" rendered="#{SetUpDataExplorationPage.showFilterVariables}">
                                <ice:inputText id="inputUpdateFilterVariableList"
                                               size="25"
                                               maxlength="255"
                                               partialSubmit="true"
                                               onchange="submit()"
                                               valueChangeListener="#{SetUpDataExplorationPage.updateFilterVariableList}"
                                               binding="#{SetUpDataExplorationPage.inputVariableFilter}"/>
                                <ice:commandButton id="saveFilterVariables" visible="true" value="Save Variable Update"
                                                   action="#{SetUpDataExplorationPage.saveFilterVariableUpdate}"/>
                                <ice:commandButton id="cancelFilterVariables" visible="true" value="Cancel"
                                                   action="#{SetUpDataExplorationPage.cancelVariableUpdate}"/>
                                <ice:commandButton id="updateFilterVariables" visible="false"/>
                                <ice:dataTable width="100%" cellspacing="0" cellpadding="0" id="filterVariables" var="dataFilterVariableUI" value="#{SetUpDataExplorationPage.dvFilterFilteredListUI}">
                                    <ice:column>
                                        <f:facet name="header">
                                            <ice:outputText value="Select"/>
                                        </f:facet>
                                        <ice:selectBooleanCheckbox id="filterVariableCheckBoxes" styleClass="filterVariableCheckBoxes"
                                                                   partialSubmit="false" value="#{dataFilterVariableUI.selected}"/>
                                    </ice:column>
                                    <ice:column>
                                        <f:facet name="header">
                                            <ice:outputText value="Name"/>
                                        </f:facet>
                                        <ice:outputLabel value="#{dataFilterVariableUI.dataVariable.name}"/>
                                    </ice:column>
                                </ice:dataTable>
                            </div>

                        </div>

                    </div>

                </div>

            </ice:panelTab>
        </ice:panelTabSet>

    </div>


</ice:form>

</ui:define>
</ui:composition>
</body>
</html>
