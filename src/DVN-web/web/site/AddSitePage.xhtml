<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:gui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core" 
      xmlns:jsp="http://java.sun.com/JSP/Page"
       xmlns:ice="http://www.icesoft.com/icefaces/component"
      >
<head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

</head>

<body>
<gui:composition template="/template.xhtml">

<gui:param name="pageTitle" value="DVN - Add Dataverse" />

  <gui:define name="body">

        <ice:form id="addsiteform">
          <ice:outputText id="statusMessage" styleClass="#{AddSitePage.msg.styleClass}" value="#{AddSitePage.msg.messageText}" />  
          <script type="text/javascript">
                //<![CDATA[
                 function changeValue(obj) {
                    if (window.event)
                        obj.value = window.event.srcElement.value;
                        document.getElementById('addsiteform').submit();
                }
                 
                 //init the hidden fields
                 function showAll(){
                    var theForm = document.getElementById('addsiteform');
                    var showScholarFields = false;
                    for (var i = 0; i < theForm.elements.length; i++) {
                        if ( (theForm.elements[i].checked) && (theForm.elements[i].value == "Scholar") ) {
                            showScholarFields = true;
                            break;
                        }
                    }
                    if (!showScholarFields) {
                        document.getElementById('addsiteform:firstName').style.display = 'none';
                        document.getElementById('addsiteform:lastName').style.display = 'none';
                    }
                }
                
                function createDvName() {
                    if (document.getElementById('addsiteform:firstName').value != "" && document.getElementById('addsiteform:lastName').value != "") {
                        document.getElementById('addsiteform:dataverseName').value = document.getElementById('addsiteform:firstName').value + " " + document.getElementById('addsiteform:lastName').value;
                    }
                }
                 // ]]>
            </script>
            
            <div jsfc="ice:panelGroup" styleClass="#{ (LoginWorkflowBean.creatorWorkflow) ? 'dvn_createDvRequest dvn_section dvn_overflow' : 'dvn_section'}">
                <div jsfc="ice:panelGroup" styleClass="#{ (LoginWorkflowBean.creatorWorkflow) ? 'requestHeader dvn_overflow' : 'dvn_sectionTitle'}">
                      <ice:outputText value="Add a New Dataverse" rendered="#{LoginWorkflowBean.plainWorkflow}"/>
                      <ice:outputText value="Add a New Dataverse" rendered="#{LoginWorkflowBean.fileAccessWorkflow}"/>
                      <ice:outputText value="Name Dataverse &lt;span&gt;&gt; Create Your Own Dataverse&lt;/span&gt;" rendered="#{LoginWorkflowBean.creatorWorkflow}" escape="false"/>
                </div>
              <div jsfc="ice:panelGroup" rendered="#{LoginWorkflowBean.creatorWorkflow}" styleClass="requestTimeline" style="background-position: 0 -8px;">
                        <div class="requestTimelinePoint" style="left: 51px;"><img src="/dvn/resources/lrg-blue-bullet.gif" class="vdcNoBorder" alt=""/><br/><strong style="color:#035899;">Create Account</strong></div>
                        <div class="requestTimelinePoint" style="left: 249px;"><img src="/dvn/resources/lrg-blue-bullet.gif" class="vdcNoBorder" alt=""/><br/><strong style="color:#035899;">Terms of Use</strong></div>
                        <div class="requestTimelinePoint" style="left: 435px;"><img src="/dvn/resources/lrg-blue-bullet.gif" class="vdcNoBorder" alt=""/><br/><strong style="color:#035899; font-weight:bold;">Name Dataverse</strong></div>
                        <div class="requestTimelinePoint" style="left: 651px;"><img src="/dvn/resources/lrg-grey-bullet.gif" class="vdcNoBorder" alt=""/><br/><strong>Success!</strong></div>
              </div>
                <div jsfc="ice:panelGroup" styleClass="#{ (LoginWorkflowBean.creatorWorkflow) ? 'requestContent' : 'dvn_sectionBox'}">
                    
            
                    <div jsfc="ice:panelGroup" styleClass="#{ (LoginWorkflowBean.creatorWorkflow) ? 'requestContentDescRight' : 'empty'}">
                    <div styleClass="dvn_margin12"> 
                    
                        <div jsfc="ice:panelGroup" rendered="#{LoginWorkflowBean.plainWorkflow or LoginWorkflowBean.fileAccessWorkflow}"  style="margin-bottom:20px;">
                            <ice:graphicImage alt="Information" title="Information" styleClass="vdcNoBorders" style="vertical-align: bottom" value="/resources/icon_info.gif" />
                            <ice:outputText id="outputText2c" styleClass="vdcHelpText" value="When your dataverse is created, it will be set to 'Coming Soon' (Not Released) by
                            default. As soon as you are ready to make it available (Released), you can do so by going to 'My Options' in your new dataverse."/>
                        </div>
                        <ice:panelGrid cellpadding="0" cellspacing="0"
                                     columnClasses="vdcAddSiteCol1, vdcAddSiteCol2" columns="2" id="gridPanel1">
                            <!-- dataverse type -->
                            <div jsfc="ice:panelGroup" >
                                <ice:outputLabel for="dataverseType" id="dataverseLabel">
                                    <ice:outputText value="Type of Dataverse"/>                                              
                                </ice:outputLabel>
                            </div>
                            <div>
                                <ice:selectOneRadio id="dataverseType"
                                                    layout="pageDirection" 
                                                    immediate="true"
                                                    onclick="changeValue(this);"
                                                    value="#{AddSitePage.dataverseType}"
                                                    valueChangeListener="#{AddSitePage.changeDataverseOption}"
                                                    required="true"
                                                    requiredMessage="This field is required.">
                                       <f:selectItems value="#{AddSitePage.dataverseOptions}"/>
                                </ice:selectOneRadio>
                            </div>
                            <!-- first name -->
                            <div jsfc="ice:panelGroup" rendered="#{AddSitePage.dataverseType == 'Scholar'}" >
                                <ice:outputLabel for="firstName" id="firstnameLabel">
                                    <ice:outputText value="First Name"/>                                              
                                    <ice:graphicImage value="#{bundle.iconRequired}"/>
                                </ice:outputLabel>
                            </div>
                            <div jsfc="ice:panelGroup" rendered="#{AddSitePage.dataverseType == 'Scholar'}" >
                                <ice:inputText id="firstName" 
                                                onblur="createDvName();"
                                                required="#{(AddSitePage.dataverseType == 'Scholar') ? true : false}"
                                                requiredMessage="This field is required."
                                                validator="#{AddSitePage.validateIsEmpty}"
                                                value="#{AddSitePage.firstName}" 
                                                valueChangeListener="#{AddSitePage.changeFirstName}"
                                                style="display:block;"/>
                                 <ice:message for="firstName" showSummary="true" showDetail="false" errorClass="errorMessage" styleClass="errorMessage"/>
                            </div>
                            <!-- last name -->
                            <div jsfc="ice:panelGroup" rendered="#{AddSitePage.dataverseType == 'Scholar'}" >
                                <ice:outputLabel for="lastName" id="lastnameLabel">
                                    <ice:outputText value="Last Name"/> 
                                    <ice:graphicImage value="#{bundle.iconRequired}"/>
                                </ice:outputLabel>
                            </div>
                            <div jsfc="ice:panelGroup" rendered="#{AddSitePage.dataverseType == 'Scholar'}" >
                                <ice:inputText id="lastName" 
                                             onblur="createDvName();"
                                             required="#{(AddSitePage.dataverseType == 'Scholar') ? true : false}"
                                             requiredMessage="This field is required."
                                             validator="#{AddSitePage.validateIsEmpty}"
                                             value="#{AddSitePage.lastName}" 
                                             valueChangeListener="#{AddSitePage.changeLastName}"
                                             style="display:block;"/>
                                <ice:message for="lastName" showSummary="true" showDetail="false" errorClass="errorMessage" styleClass="errorMessage"/>
                            </div>
                            <!-- affiliation -->
                            <div>
                                <ice:outputLabel for="affiliation" id="affiliationLabel">
                                    <ice:outputText value="Affiliation"/>                                              
                                </ice:outputLabel>
                            </div>
                            <div>
                                <ice:inputText id="affiliation" immediate="true" value="#{AddSitePage.affiliation}" valueChangeListener="#{AddSitePage.changeAffiliation}" />
                                <br />
                                <ice:outputText styleClass="vdcHelpText" value="University, center, or research project."/>
                            </div>
                            <!-- Dataverse Name -->
                            <div>
                                <ice:outputLabel binding="#{AddSitePage.componentLabel1}" for="componentLabel1" id="componentLabel1">
                                    <ice:outputText binding="#{AddSitePage.componentLabel1Text}" id="componentLabel1Text" value="Dataverse Name"/>                                              
                                    <ice:graphicImage value="#{bundle.iconRequired}"/>
                                </ice:outputLabel>
                            </div>
                            <div>
                                <ice:inputText binding="#{AddSitePage.dataverseName}" id="dataverseName" 
                                                required="#{(AddSitePage.dataverseType == 'Scholar') ? false : true}"
                                                requiredMessage="This field is required." 
                                                validator="#{AddSitePage.validateName}" size="45" />
                                <br />
                                <ice:outputText styleClass="vdcHelpText" value="Name used to refer to this dataverse in Dataverse Network Homepage and other pages."/>
                                <ice:message for="dataverseName" showSummary="true" showDetail="false" errorClass="errorMessage" styleClass="errorMessage"/>
                            </div>
                            <!-- Dataverse Alias -->
                            <div>
                                <ice:outputLabel binding="#{AddSitePage.componentLabel2}" for="componentLabel2" id="componentLabel2">
                                    <ice:outputText binding="#{AddSitePage.componentLabel2Text}" id="componentLabel2Text" value="Dataverse Alias"/> 
                                    <ice:graphicImage value="#{bundle.iconRequired}"/>
                                </ice:outputLabel>
                            </div>
                            <div jsfc="ice:panelGroup">
                                <ice:inputText binding="#{AddSitePage.dataverseAlias}" 
                                                id="dataverseAlias"
                                                required="true" 
                                                requiredMessage="This field is required."
                                                validator="#{AddSitePage.validateAlias}" />
                                <br />
                                <ice:outputText styleClass="vdcHelpText" value="Short name used to build the URL for this dataverse, e.g., http://.../dv/'alias'. It is case sensitive."/>
                                <ice:message for="dataverseAlias" showSummary="true" showDetail="false" errorClass="errorMessage" styleClass="errorMessage"/>
                            </div>
                            <!-- Group Assignment -->
                            <div jsfc="ice:panelGroup" >
                                <ice:outputLabel for="selectedGroup" id="selectedGroupLabel">
                                    <ice:outputText id="selectedGroupText" value="Group Assignment"/> 
                                </ice:outputLabel>
                            </div>
                            <div jsfc="ice:panelGroup" rendered="#{AddSitePage.dataverseType == 'Basic'}">
                                <ice:selectOneMenu id="selectedGroup" 
                                    immediate="true"
                                    onchange="this.form.submit();"
                                    value="#{AddSitePage.selectedGroup}"
                                    valueChangeListener="#{AddSitePage.changeSelectedGroup}">
                                    <f:selectItems value="#{AddSitePage.groupItems}" />
                                </ice:selectOneMenu>
                                <br />
                                <ice:outputLabel styleClass="vdcHelpText" for="selectedGroup" value="#{bundle.groupSelect}"/>
                            </div>
                            <div jsfc="ice:panelGroup" rendered="#{AddSitePage.dataverseType == 'Scholar'}">
                                <ice:outputText styleClass="vdcHelpText" id="scholarDataverseGroup" 
                                    value="#{bundle.scholarGroupSelect}" />
                            </div>
                        </ice:panelGrid>
                        <div style="padding-left: 160px">
                            <ice:commandButton rendered="#{AddSitePage.dataverseType != 'Scholar'}" id="button1" value="Save" action="#{AddSitePage.create}"/>
                            <ice:commandButton rendered="#{AddSitePage.dataverseType == 'Scholar'}" id="btnCreateSdv" value="Save" action="#{AddSitePage.createScholarDataverse}"/>
                            <ice:commandButton binding="#{AddSitePage.button2}" id="button2" style="margin-left: 20px" immediate="true" value="Cancel" action="#{AddSitePage.cancel}"/>
                        </div>
                      <script type="text/javascript">
                            //<![CDATA[
                                 
                                    // this is done to ensure that the scholar fields are properly inited. wjb
                                    showAll();
                            // ]]>
                        </script>
                       
                    </div>
                    </div>
                    
                </div>
            </div>
        </ice:form>
            </gui:define>
        </gui:composition>
    </body>
</html>