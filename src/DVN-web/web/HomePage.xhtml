<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:gui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:jsp="http://java.sun.com/JSP/Page"
      xmlns:dvn="/WEB-INF/tlds/dvn-components"
      xmlns:ice="http://www.icesoft.com/icefaces/component">
<head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
</head>

<body>
  <gui:composition template="/template.xhtml">
    <gui:param name="pageTitle" value="DVN - Home" />

    <gui:define name="body">
      <f:loadBundle basename="Bundle" var="bundle"/>
      <f:loadBundle basename="BundleAnalysis" var="bundleAnalysis"/>
      <script type="text/javascript">
          // <![CDATA[

          function setHiddenValues(groupid) {
            if (arguments[0] == "All") {
                document.getElementById('HomePageForm:filterType').value = 'all';
            } else if (arguments.length > 1) {
                document.getElementById('HomePageForm:filterType').value = 'alphabetic';
                document.getElementById('HomePageForm:alphaCharacter').value = arguments[1];
            } else {
                document.getElementById('HomePageForm:filterType').value = 'numeric';
                document.getElementById('HomePageForm:groupId').value = arguments[0];
                oldGroupId = arguments[0];
            }
          }

         jQuery.noConflict();

         function toggleMoreInfo(moreInfo) {
            jQuery(moreInfo).next().slideToggle(500);
            var toggleLabelText = (jQuery(moreInfo).children('span.iceOutTxt').text() == 'more info [+]') ? 'less info [-]' : 'more info [+]';
            jQuery(moreInfo).children('span.iceOutTxt').text(toggleLabelText);
            return false;
         };

          // ]]>
      </script>

      <ice:outputText escape="false"
                      value="#{HomePage.accordionJavascript}"
                    />

      <ice:form id="HomePageForm">
        <ice:inputHidden id="vdcId" value="#{VDCRequest.currentVDCId}"/>
        <!-- Success Message -->
        <div jsfc="ice:panelGroup" styleClass="#{HomePage.msg.styleClass}" rendered="#{!empty HomePage.msg.messageText}">
          <ice:outputText id="statusMessage" escape="false" value="#{HomePage.msg.messageText}"/>
        </div>

        <div jsfc="ice:panelGroup" styleClass="dvn_hmpgMainMessage" rendered="#{(VDCRequest.vdcNetwork.displayAnnouncements == true) and (VDCRequest.currentVDC == null) }" id="networkAnnouncementsHeaderPanel" >
          <ice:outputText id="networkAnnouncementsMessages" escape="false" value="#{HomePage.parsedNetworkAnnouncements}"/>
        </div>

        <div jsfc="ice:panelGroup" styleClass="dvn_hmpgMainMessage" rendered="#{VDCRequest.currentVDC.displayAnnouncements == true}" id="announcementsHeaderPanel" >
          <ice:outputText rendered="#{VDCRequest.currentVDC.displayAnnouncements == true}" escape="false" value="#{HomePage.parsedLocalAnnouncements}"/>
        </div>

        <!-- Main Section starts here -->
        <div id="dvn_mainSection">
          <!-- Search Section starts here -->
          <div class="dvn_searchblock">
            <div class="dvn_searchBoxContent">
              <div class="dvn_searchTitle"><a name="search" title="">Search Studies</a></div>
              <fieldset>
                <label for="options">
                  <ice:selectOneMenu id="dropdown1" value="#{HomePage.searchField}">
                    <f:selectItem itemLabel="Cataloging Information" itemValue="any" />
                    <f:selectItem itemLabel="- Author" itemValue="authorName" />
                    <f:selectItem itemLabel="- Title" itemValue="title" />
                    <f:selectItem itemLabel="- Global ID" itemValue="globalId" />
                    <f:selectItem itemLabel="Variable Information" itemValue="variable"/>
                  </ice:selectOneMenu>
                </label>
                <label for="search">
                  <ice:inputText onkeypress="if (window.event) return processEvent('', 'form1:searchButton'); else return processEvent(event, 'form1:searchButton');" id="textField2" value="#{HomePage.searchValue}"/>
                </label>
                <label for="button">
                  <ice:commandButton id="searchButton" value="Go" type="submit" action="#{HomePage.search_action}"/>
                </label>
              </fieldset>
              <div class="dvn_searchLinks">
                <ice:outputLink value="/dvn#{VDCRequest.currentVDCURL}/faces/AdvSearchPage.xhtml">
                  <ice:outputText value="Advanced Search"/>
                </ice:outputLink>
                &#160;| &#160;
                <ice:outputLink value="http://thedata.org/guides/users/search/tips" target="_blank" style="margin: 0;">
                  <ice:outputText value="Tips"/>
                </ice:outputLink>
              </div>
            </div>
          </div>
          <!-- Search Section ends here -->
        </div>
        <!-- Main Section ends here -->
        

        <div id="hiddenDiv" style="display:none;">
          <ice:outputText value="#{NetworkStatsBean.autoLoad}"/>
        </div>


        <!-- ***************** NETWORK HOMEPAGE CONTENT *************************  -->

        <div jsfc="ice:panelGroup" styleClass="#{!empty(HomePage.accordionItemBeans) ? 'dvn_section dvn_overflow' : 'dvn_section'}">
            
          <!-- MAIN CONTENT AREA -->
          <div jsfc="ice:panelGroup" styleClass="#{!empty(HomePage.accordionItemBeans) ? 'dvn_sectionContent' : 'dvn_sectionContentNoPanels'}">
             <div class="dvnHmpgGroupHeaderBlock">
                 <ice:outputText styleClass="dvnHmpgGroupHeader" value="#{HomePage.groupName}"/>
                 <div jsfc="ice:panelGroup"
                      styleClass="dvnHmpgGroupCreateBlock"
                      id="createDataverse"
                      rendered="#{HomePage.showRequestCreator}">
                     <ice:outputLink styleClass="dvnHmpgGroupCreateLink" value="/dvn/faces/login/CreatorRequestInfoPage.xhtml">
                         <ice:outputText value="Create your own Dataverse" escape="false"/>
                     </ice:outputLink>
                 </div>
             </div>
             <div jsfc="ice:panelGroup" styleClass="dvnHmpgClassificationDesc" rendered="#{HomePage.group.description != null and HomePage.group.description != ''}">
                 <p><ice:outputText value="#{HomePage.group.description}"/></p>
             </div>
             <div jsfc="ice:panelGroup" styleClass="dvnHmpgGroupTableWrap">
                <div jsfc="ice:panelGroup" styleClass="dvnHmpgGroupAlphaSortBlock" rendered="#{VDCRequest.currentVDC == null}">
                    <ul class="dvnAlphaBrowse">
                        <li>
                            <ice:commandLink  onclick="setHiddenValues('All');">
                                <ice:outputText value="ALL"/>
                            </ice:commandLink>
                        </li>
                        <gui:repeat value="#{HomePage.alphaCharacterList}"
                                    var="item">
                            <li>
                                <ice:commandLink onclick="setHiddenValues(document.getElementById('HomePageForm:groupId').value, '#{item}');">
                                    <ice:outputText value="#{item}"/>
                                    <f:attribute name="groupId" value="#{item.id}"/>
                                    <f:attribute name="alphaCharacter" value="#{item}"/>
                                </ice:commandLink>
                            </li>
                        </gui:repeat>
                    </ul>
                </div>
                <ice:panelGrid cellpadding="0" cellspacing="0" border="0" columns="2" id="gridPanel2"
                               styleClass="dvnHmpgGroupTableTop"
                               columnClasses="dvnHmpgGroupTotals, dvnPaginatorWrap"
                               rendered="#{!empty(HomePage.vdcUIList.vdcUIList)}">
                      <div jsfc="ice:panelGroup"
                                id="groupPanel1"
                                rendered="#{!empty(HomePage.vdcUIList.vdcUIList) and VDCRequest.currentVDC == null}">
                            <ice:outputText styleClass="dvn_totalsLabel" value ="Dataverses: "/>
                                <ice:outputText styleClass="dvn_totalsValue"
                                            value="#{HomePage.vdcUIListSize}"/>
                                 <ice:outputText escape="false"
                                            rendered="#{HomePage.groupName == 'All Dataverses' and HomePage.isAlphaSort == false}"
                                            styleClass="dvn_totalsLabel"
                                            value=" | "/>
                            <ice:outputText rendered="#{HomePage.groupName == 'All Dataverses' and HomePage.isAlphaSort == false}"
                                            styleClass="dvn_totalsLabel"
                                            value ="Studies: "/>
                                <ice:outputText rendered="#{HomePage.groupName == 'All Dataverses' and HomePage.isAlphaSort == false}"
                                                styleClass="dvn_totalsValue"
                                                value="#{HomePage.studyCount}"/>
                            <ice:outputText escape="false"
                                            rendered="#{HomePage.groupName == 'All Dataverses' and HomePage.isAlphaSort == false}"
                                            styleClass="dvn_totalsLabel"
                                            value=" | "/>
                            <ice:outputText rendered="#{HomePage.groupName == 'All Dataverses' and HomePage.isAlphaSort == false }"
                                            styleClass="dvn_totalsLabel"
                                            value="Files: " />
                            <ice:outputText rendered="#{HomePage.groupName == 'All Dataverses' and HomePage.isAlphaSort == false }"
                                            styleClass="dvn_totalsValue"
                                            value="#{HomePage.fileCount}"/>
                      </div>
                      <div jsfc="ice:panelGroup"
                            id="groupPanel2"
                            rendered="#{HomePage.vdcUIListSize > 10 and VDCRequest.currentVDC == null}">
                        <div class="dvnPaginatorFloatRight">
                        <ice:dataPaginator for="dataverseList"
                                           id="dataScroll_3"
                                           paginator="true" fastStep="3"
                                           paginatorMaxPages="4"
                                           renderFacetsIfSinglePage="true"
                                           styleClass="dvnPaginatorRight">
                          <f:facet name="first">
                            <ice:graphicImage url="/resources/icefaces/dvn_rime/css-images/arrow-first.gif" title="First Page"/>
                          </f:facet>
                          <f:facet name="fastrewind">
                              <ice:graphicImage url="/resources/icefaces/dvn_rime/css-images/arrow-fr.gif" title="Fast Backward"/>
                          </f:facet>
                          <f:facet name="previous">
                            <ice:graphicImage url="/resources/icefaces/dvn_rime/css-images/arrow-previous.gif" title="Previous"/>
                          </f:facet>
                          <f:facet name="next">
                            <ice:graphicImage url="/resources/icefaces/dvn_rime/css-images/arrow-next.gif" title="Previous"/>
                          </f:facet>
                          <f:facet name="fastforward">
                              <ice:graphicImage url="/resources/icefaces/dvn_rime/css-images/arrow-ff.gif" title="Fast Forward"/>
                          </f:facet>
                          <f:facet name="last">
                            <ice:graphicImage url="/resources/icefaces/dvn_rime/css-images/arrow-last.gif" title="Previous"/>
                          </f:facet>
                        </ice:dataPaginator>
                        </div>
                      </div>                  
                </ice:panelGrid>
             </div>
             <div jsfc="ice:panelGroup" styleClass="dvnHmpgGroupNoDVs" rendered="#{HomePage.vdcUIListSize == 0}">
                  <p><ice:outputText value="There are no dataverses to display for the selected filter. Please select again."/></p>
             </div>
             <div jsfc="ice:panelGroup" rendered="#{!empty(HomePage.vdcUIList.vdcUIList)}">

               <ice:dataTable headerClass="groupRow" id="dataverseList"
                               rendered="#{!empty(HomePage.vdcUIList.vdcUIList)}"
                               rowClasses="evenRow oddRow" rows="10" width="100%" columnWidths="35%,35%,10%,10%,10%"
                               sortColumn="#{HomePage.vdcUIList.sortColumnName}"
                               sortAscending="#{HomePage.vdcUIList.ascending}"
                               styleClass="dvnHmpgGroupDataTable"
                               value="#{HomePage.vdcUIList.vdcUIList}" var="item"><!-- this is a list of vdcs -->
                  <!-- name number -->
                  <f:facet name="header">

                  </f:facet>
                  <ice:column>
                    <f:facet name="header">
                      <ice:commandSortHeader
                        columnName="#{HomePage.vdcUIList.nameColumnName}"
                        arrow="true">
                        <ice:outputText value="#{HomePage.vdcUIList.nameColumnName}"/>
                      </ice:commandSortHeader>
                    </f:facet>
                    <ice:outputLink styleClass="dvnHmpgDvNameLink" id="dataverse_link" value="/dvn/dv/#{item.vdc.alias}">
                      <ice:outputText rendered="#{item.vdc.dtype != 'Scholar'}" value="#{item.vdc.name}"/>
                      <ice:outputText rendered="#{item.vdc.dtype == 'Scholar'}" value="#{item.vdc.lastName}, #{item.vdc.firstName}"/>
                    </ice:outputLink>
                    <ice:outputLink rendered="#{!empty item.vdc.dvnDescription}"
                                    styleClass="dvnHmpgMoreInfoLink"
                                    value="#"
                                    onclick="return toggleMoreInfo(this)">
                      <ice:outputText value="more info [+]"/>
                    </ice:outputLink>
                    <div jsfc="ice:panelGroup" styleClass="dvnHmpgDvMoreInfoDesc" style="display: none;">
                      <ice:outputText rendered="#{item.vdc.dvnDescription != null}" value="#{item.vdc.dvnDescription}"/>
                    </div>
                  </ice:column>
                  <!-- affiliation -->
                  <ice:column>
                   <f:facet name="header">
                      <ice:commandSortHeader
                        columnName="#{HomePage.vdcUIList.affiliationColumnName}"
                        arrow="true">
                        <ice:outputText value="#{HomePage.vdcUIList.affiliationColumnName}"/>
                      </ice:commandSortHeader>
                    </f:facet>
                    <ice:outputText value="#{item.vdc.affiliation}"/>
                  </ice:column>
                
                  <!-- DateReleased  -->
                  <ice:column>
                   <f:facet name="header">
                      <ice:commandSortHeader
                        columnName="#{HomePage.vdcUIList.dateReleasedColumnName}"
                        arrow="true">
                        <ice:outputText value="#{HomePage.vdcUIList.dateReleasedColumnName}"/>
                      </ice:commandSortHeader>
                    </f:facet>
                    <ice:outputText value="#{item.releaseDate}"/>
                  </ice:column>

                  <!-- Activity -->
                  <ice:column styleClass="activityColumn">
                   <f:facet name="header">
                      <ice:commandSortHeader
                        columnName="#{HomePage.vdcUIList.activityColumnName}"
                        arrow="true" title="Activity data tracked since DVN 1.4 released">
                        <ice:outputText value="#{HomePage.vdcUIList.activityColumnName}"/>
                      </ice:commandSortHeader>
                    </f:facet>
                    <div class="activity">
                      <div jsfc="ice:panelGroup" styleClass="#{item.activityClass}">
                        <span class="numbervalue">0</span>
                      </div>
                    </div>
                  </ice:column>
                </ice:dataTable>
              </div>

            </div>
              <!-- START THE MENU -->
            <div jsfc="ice:panelGroup" styleClass="dvn_sectionPanels" rendered="#{!empty(HomePage.accordionItemBeans)}">
            <div jsfc="ice:panelGroup" styleClass="dvn_theMenuContainer">
                <div class="theMenuContainer">
                <!-- START ACCORDION -->
                <!-- All Dataverses -->
                     <ul id="theMenu">
                         <li>
                             <h3 class="head noSubNode">
                                 <ice:commandLink onclick="setHiddenValues(-1);"
                                                  partialSubmit="true"
                                                  styleClass="head">
                                     <ice:outputText value="Show All Dataverses"/>
                                     <f:attribute name="groupId" value="-1"/>
                                 </ice:commandLink>
                             </h3>
                         </li>
                         <gui:repeat rendered="#{HomePage.accordionItemBeans != null}"
                                     value="#{HomePage.accordionItemBeans}"
                                     var="menuItems">
                             <gui:fragment rendered="#{!empty(menuItems.childItems)}">
                             <li>
                                 <h3 class="head">
                                     <ice:outputLink styleClass="head">
                                         <ice:outputText value="#{menuItems.name}"/>
                                     </ice:outputLink>
                                 </h3>
                                 <ul>
                                     <li>
                                         <ul class="xtraMenu">
                                             <gui:repeat rendered="#{menuItems != null}"
                                                         value="#{menuItems.childItems}"
                                                         var="item">
                                                 <!-- HAS SUBNODE DESCENDANTS -->
                                                 <gui:fragment rendered="#{!empty(item.xtraItems)}">
                                                     <li id="xtraMenu#{item.id}">
                                                         <h4 class="head">
                                                             <ice:commandLink onclick="setHiddenValues(#{item.id});"
                                                                              partialSubmit="true"
                                                                              stylClass="head">
                                                                 <ice:outputText value="#{item.name}"/>
                                                                 <f:attribute name="groupId" value="#{item.id}"/>
                                                             </ice:commandLink>
                                                         </h4>
                                                         <gui:fragment rendered="#{item.xtraItems != null and !empty(item.xtraItems)}">
                                                             <ul>
                                                                 <gui:repeat rendered="#{item.xtraItems != null}"
                                                                             value="#{item.xtraItems}"
                                                                             var="xtraItems">
                                                                     <li>
                                                                         <ice:commandLink onclick="setHiddenValues(#{xtraItems.id});"
                                                                                          partialSubmit="true">
                                                                             <ice:outputText value="#{xtraItems.name}"/>
                                                                             <f:attribute name="groupId" value="#{xtraItems.id}"/>
                                                                         </ice:commandLink>
                                                                     </li>
                                                                 </gui:repeat>
                                                             </ul>
                                                         </gui:fragment>
                                                         <gui:fragment rendered="#{item.xtraItems == null or empty(item.xtraItems)}">
                                                             <gui:repeat rendered="#{item.xtraItems == null}"
                                                                         value="#{item.xtraItems}"
                                                                         var="xtraItems">
                                                                 <li>
                                                                     <ice:commandLink onclick="setHiddenValues(#{xtraItems.id});"
                                                                                      partialSubmit="true">
                                                                         <ice:outputText value="#{xtraItems.name}"/>
                                                                         <f:attribute name="groupId" value="#{xtraItems.id}"/>
                                                                     </ice:commandLink>
                                                                 </li>
                                                             </gui:repeat>
                                                         </gui:fragment>
                                                     </li>
                                                 </gui:fragment>
                                                 <!-- END HAS SUBNODE DESCENDANTS -->
                                                 <!-- HAS NO SUBNODE DESCENDANTS -->
                                                 <gui:fragment rendered="#{empty(item.xtraItems)}">
                                                     <li>
                                                         <h4 class="head noSubNode">
                                                             <ice:commandLink onclick="setHiddenValues(#{item.id});"
                                                                              partialSubmit="true">
                                                                 <ice:outputText value="#{item.name}"/>
                                                                 <f:attribute name="groupId" value="#{item.id}"/>
                                                             </ice:commandLink>
                                                         </h4>
                                                     </li>
                                                 </gui:fragment>
                                                 <!-- END HAS NO SUBNODE DESCENDANTS -->
                                             </gui:repeat>
                                         </ul>
                                     </li>
                                 </ul>
                             </li>
                             </gui:fragment>
                         </gui:repeat>
                     </ul>
                </div>
            </div>
          </div>
          <!-- END THE MENU -->
              <ice:inputHidden  binding="#{HomePage.hiddenFilterType}"
                        id="filterType"
                        valueChangeListener="#{HomePage.changeFilterType}"
                        />
              <ice:inputHidden  binding="#{HomePage.hiddenAlphaCharacter}"
                                    id="alphaCharacter"
                                    valueChangeListener="#{HomePage.changeAlphaCharacter}"
                                    />
               <ice:inputHidden  binding="#{HomePage.hiddenGroupId}"
                                    id="groupId"
                                    valueChangeListener="#{HomePage.changeGroupId}"
                                    />
          <ice:messages></ice:messages>
        </div>
      </ice:form>

    </gui:define>
  </gui:composition>
</body>
</html>